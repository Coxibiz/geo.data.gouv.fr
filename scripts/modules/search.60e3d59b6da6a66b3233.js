webpackJsonp([4],{202:function(e,t,r){"use strict";function n(e,t){return Object(a.a)(e,t)}var a=r(50);t.a=n},206:function(e,t,r){"use strict";function n(e){return"function"==typeof e?e:u.a}function a(e,t){return(Object(l.a)(e)?i.a:o.a)(e,c(t))}var i=r(207),o=r(49),u=r(21),c=n,l=r(5);t.a=a},207:function(e,t,r){"use strict";function n(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}t.a=n},209:function(e,t,r){"use strict";function n(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}t.a=n},223:function(e,t){e.exports={label:"FiltersSummary-qihw02rE"}},225:function(e,t){e.exports={container:"FacetsGroup-1rE0RbSG"}},232:function(e,t){e.exports={container:"SearchResult-BC1quGiz",list:"SearchResult-2J9rvEwf"}},233:function(e,t){e.exports={container:"SearchPagination-18Q0cOcH",page:"SearchPagination-a3oZiNlf",disabled:"SearchPagination-3_bWlhyy",break:"SearchPagination-2bSilu2g",pageLink:"SearchPagination-1UwN844_",active:"SearchPagination-2N2emten"}},234:function(e,t){e.exports={results:"SearchResults-Hv3B_jdB",result:"SearchResults-1Qx6fsA_",loader:"SearchResults-3c4P9TdQ",paginationWrapper:"SearchResults-1HNoDkbc"}},235:function(e,t){e.exports={container:"SearchPage-p63y_zUY",search:"SearchPage-lggXKdsm"}},236:function(e,t,r){function n(e){return r(a(e))}function a(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./en.json":237,"./fr.json":238};n.keys=function(){return Object.keys(i)},n.resolve=a,e.exports=n,n.id=236},237:function(e,t){e.exports={FiltersSummary:{activeFilters:"Active filter",activeFilters_plural:"Active filters",noFilters:"No filters"},SearchPage:{documentTitle:"Search dataset"},SearchPagination:{previous:"Previous",next:"Next"},SearchResult:{keywords:"Keyword",keywords_plural:"Keywords",organizations:"Organization",organizations_plural:"Organizations"},SearchResultsCount:{results:"{{count}} dataset found.",results_plural:"{{count}} datasets found.",noResults:"No datasets found."}}},238:function(e,t){e.exports={FiltersSummary:{activeFilters:"Filtre actif",activeFilters_plural:"Filtres actifs",noFilters:"Aucun filtre"},SearchPage:{documentTitle:"Recherche jeu de données"},SearchPagination:{previous:"Précédent",next:"Suivant"},SearchResult:{keywords:"Mot-clé",keywords_plural:"Mots-clés",organizations:"Organisation",organizations_plural:"Organisations"},SearchResultsCount:{results:"{{count}} jeu de données trouvé.",results_plural:"{{count}} jeux de données trouvé.",noResults:"Aucun jeu de données trouvé."}}},370:function(e,t,r){"use strict";function n(e,t){return!!(null==e?0:e.length)&&Object(k.a)(e,t,0)>-1}function a(e,t,r){for(var n=-1,a=null==e?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}function i(){}function o(e,t,r){var n=-1,a=F,i=e.length,o=!0,u=[],c=u;if(r)o=!1,a=x;else if(i>=q){var l=t?null:L(e);if(l)return Object(T.a)(l);o=!1,a=R.a,c=new _.a}else c=t?[]:u;e:for(;++n<i;){var s=e[n],f=t?t(s):s;if(s=r||0!==s?s:0,o&&f===f){for(var p=c.length;p--;)if(c[p]===f)continue e;t&&c.push(f),u.push(s)}else a(c,f,r)||(c!==u&&c.push(f),u.push(s))}return u}function u(e){return Object(H.a)(e)&&Object(U.a)(e)}function c(e,t){var r;return Object(le.a)(e,function(e,n,a){return!(r=t(e,n,a))}),!!r}function l(e,t,r){var n=Object(fe.a)(e)?ue.a:se;return r&&Object(pe.a)(e,t,r)&&(t=void 0),n(e,Object(ce.a)(t,3))}function s(e){return he[e]||e}function f(e,t){return de(e,t)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function y(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function m(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(t,"__esModule",{value:!0});var E,S=r(204),O=r(46),j=r(45),w=r(202),C=r(99),P=r(100),_=r(108),k=r(215),F=n,x=a,R=r(110),N=r(117),Q=i,T=r(91),A=N.a&&1/Object(T.a)(new N.a([,-0]))[1]==1/0?function(e){return new N.a(e)}:Q,L=A,q=200,z=o,U=r(18),H=r(11),I=u,X=r(209),D=Object(P.a)(function(e){var t=Object(X.a)(e);return t="function"==typeof t?t:void 0,z(Object(C.a)(e,1,I,!0),void 0,t)}),G=D,M=r(0),W=(r(1),r(3)),B=r(26),K=r(88),J=r.n(K),V=r(13),Y=r(93),Z=r(210),$=r(223),ee=r.n($),te=function(e){var t=e.filters,r=e.removeFilter,n=e.t;return M.default.createElement("div",null,M.default.createElement("div",{className:ee.a.label},t.length?n("FiltersSummary.activeFilters",{count:t.length}):n("FiltersSummary.noFilters")),t.map(function(e,t){return M.default.createElement(Z.a,{key:t,detail:!0,remove:!0,filter:e,onClick:function(e){return r(e)}})}))},re=Object(W.translate)("Search")(te),ne=re,ae=r(119),ie=r(206),oe=r(211),ue=r(109),ce=r(47),le=r(49),se=c,fe=r(5),pe=r(123),de=l,he={availability:"téléchargeable",dgvPublication:"publié sur data.gouv.fr",distributionFormat:"format de distribution",keyword:"mot-clé",metadataType:"type de metadonnée",opendata:"donnée ouverte",organization:"organisation",representationType:"type géographique",type:"type",catalog:"catalogue",yes:"oui",no:"non","not-determined":"non déterminé",other:"autre",unknown:"inconnu",none:"aucun"},ve=r(225),ge=function(e){var t=e.type,r=e.facets,n=e.filters,a=e.addFilter,i=r.map(function(e){return f(n,{name:t,value:e.value})});return-1===i.indexOf(!1)?null:M.default.createElement("div",{className:ve.container},M.default.createElement("h4",null,s(t)),r.map(function(e,r){return M.default.createElement(oe.a,{key:r,name:t,value:e.value,count:e.count,isActive:i[r],addFilter:a})}))},ye=ge,me=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),be=function(e){function t(){return p(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,e),me(t,[{key:"render",value:function(){var e=this.props,t=e.facets,r=e.filters,n=e.addFilter;if(!t)return M.default.createElement("div",null);var a=[];Object(ie.a)(t,function(e,t){var r={type:t,value:e};a.push(r)});var i=Object(ae.a)(a,"type");return M.default.createElement("div",null,i.map(function(e){return M.default.createElement(ye,{key:e.type,type:e.type,facets:e.value,filters:r,addFilter:n})}))}}]),t}(M.default.PureComponent),Ee=be,Se=function(e){var t=e.count,r=e.t;return M.default.createElement("div",null,t?r("SearchResultsCount.results",{count:t}):r("SearchResultsCount.noResults"))},Oe=Object(W.translate)("Search")(Se),je=Oe,we=r(8),Ce=r(216),Pe=r(232),_e=r.n(Pe),ke=function(e){var t=e.dataset,r=e.addFilter,n=e.t;return M.default.createElement("div",{className:_e.a.container},M.default.createElement("h4",null,M.default.createElement(we.Link,{to:"/datasets/"+t.recordId},t.metadata.title)),t.metadata.description&&M.default.createElement(Ce.a,{markdown:t.metadata.description}),M.default.createElement("h5",null,n("SearchResult.keywords",{context:t.metadata.keywords.length})),M.default.createElement("div",{className:_e.a.list},t.metadata.keywords.map(function(e,t){return M.default.createElement(Z.a,{key:t,onClick:r,filter:{value:e,name:"keyword"}})})),M.default.createElement("h5",null,n("SearchResult.organizations",{context:t.organizations.length})),M.default.createElement("div",{className:_e.a.list},t.organizations.map(function(e,t){return M.default.createElement(Z.a,{key:t,onClick:r,filter:{value:e,name:"organization"}})})))},Fe=Object(W.translate)("Search")(ke),xe=Fe,Re=r(125),Ne=r.n(Re),Qe=r(233),Te=r.n(Qe),Ae=function(e){var t=e.t,r=e.page,n=e.pageCount,a=e.onPageChange,i=e.previousLabel,o=void 0===i?t("SearchPagination.previous"):i,u=e.nextLabel,c=void 0===u?t("SearchPagination.next"):u,l=e.breakLabel,s=void 0===l?"…":l,f=r-1||0;return M.default.createElement(Ne.a,{previousLabel:o,nextLabel:c,breakLabel:s,pageCount:n,initialPage:f,marginPagesDisplayed:2,pageRangeDisplayed:5,onPageChange:a,containerClassName:Te.a.container,pageClassName:Te.a.page,breakClassName:Te.a.break,pageLinkClassName:Te.a.pageLink,previousClassName:Te.a.page,previousLinkClassName:Te.a.pageLink,nextClassName:Te.a.page,nextLinkClassName:Te.a.pageLink,activeClassName:Te.a.active})},Le=Object(W.translate)("Search")(Ae),qe=Le,ze=r(234),Ue=r.n(ze),He=function(e){var t=e.count,r=e.page,n=e.query,a=e.results,i=e.facets,o=e.addFilter,u=e.changePage,c=a?Math.ceil(t/n.limit):0;return M.default.createElement("div",null,M.default.createElement(je,{count:t}),t>0&&M.default.createElement("div",{className:Ue.a.results},M.default.createElement("div",{className:Ue.a.result},a.map(function(e){return M.default.createElement(xe,{key:e._id,dataset:e,addFilter:o})})),M.default.createElement(Ee,{facets:i,filters:n.facets,addFilter:o})),c>1&&M.default.createElement("div",{className:Ue.a.paginationWrapper},M.default.createElement(qe,{page:r,pageCount:c,onPageChange:u})))},Ie=He,Xe=Ie,De=r(235),Ge=r.n(De),Me=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),We=function(e){function t(){var e,r,n,a;v(this,t);for(var i=arguments.length,o=Array(i),u=0;u<i;u++)o[u]=arguments[u];return r=n=g(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.redirectToQuery=function(e){n.props.history.push({pathname:"/search",search:J.a.stringify(e)})},n.addFilter=function(e){var t=n.props,r=t.location,a=t.updateQuery,i=t.search;n.redirectToQuery(a(r.search,{filters:G(i.parsedQuery.filters,[e],w.a)}))},n.removeFilter=function(e){var t=n.props,r=t.location,a=t.updateQuery,i=t.search;n.redirectToQuery(a(r.search,{filters:i.parsedQuery.filters.filter(function(t){return t.name!==e.name||t.value!==e.value})}))},n.updateQuery=function(e){var t=n.props,r=t.location,a=t.updateQuery;n.redirectToQuery(a(r.search,{q:e}))},n.changePage=function(e){var t=e.selected,r=n.props,a=r.location,i=r.updateQuery,o=r.search,u=t+1;o.parsedQuery.page!==u&&n.redirectToQuery(i(a.search,{page:u}))},a=r,g(n,a)}return y(t,e),Me(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.location;(0,e.execute)(t.search)}},{key:"componentWillReceiveProps",value:function(e){var t=e.location,r=this.props.execute;t!==this.props.location&&r(t.search)}},{key:"render",value:function(){var e=this.props,t=e.search,r=e.t;return M.default.createElement("div",{className:Ge.a.container},M.default.createElement(B.Helmet,{title:r("SearchPage.documentTitle")}),M.default.createElement("div",{className:Ge.a.search},M.default.createElement(Y.a,{defaultValue:t.parsedQuery.textInput,onSearch:this.updateQuery,hasButton:!0}),M.default.createElement(ne,{filters:t.parsedQuery.filters,removeFilter:this.removeFilter})),M.default.createElement(V.a,{isLoading:t.pending,error:t.error},M.default.createElement(Xe,{page:t.parsedQuery.page,query:t.search.query,count:t.search.count,results:t.search.results,facets:t.search.facets,addFilter:this.addFilter,changePage:this.changePage})))}}]),t}(M.default.PureComponent),Be=Object(W.translate)("Search")(We),Ke=Be,Je=r(89),Ve=function(){function e(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Ye=["q","page","offset","limit"],Ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.startsWith("?")&&(e=e.substring(1)),J.a.parse(e)},$e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[],r=Ze(e);return Object.entries(r).forEach(function(e){var r=Ve(e,2),n=r[0],a=r[1];Ye.includes(n)||(Array.isArray(a)?a.forEach(function(e){t.push({name:n,value:e})}):t.push({name:n,value:a}))}),{textInput:r.q,page:parseInt(r.page,10)||1,filters:t}},et=function(e){return e.reduce(function(e,t){return(e[t.name]=e[t.name]||[]).push(t.value),e},{})},tt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],r=Ze(e),n=r.q,a=(r.page,m(r,["q","page"])),i=t.q||n,o=t.page||1;return Object.assign({},i?{q:i}:{},o&&o>1?{page:o}:{},t.filters?et(t.filters):a)},rt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return function(r){var n=$e(e);r({type:"SEARCH_EXECUTE_PENDING",parsedQuery:n});var a=et(n.filters);return Object(Je.b)("https://inspire.data.gouv.fr/api/geogw/records?"+J.a.stringify(Object.assign({},a,{q:n.textInput,offset:(n.page-1)*t,limit:t}))).then(function(e){r({type:"SEARCH_EXECUTE_SUCCESS",payload:e})}).catch(function(e){r({type:"SEARCH_EXECUTE_FAILURE",error:e})})}},nt=Object(j.connect)(function(e){return{search:e.search,updateQuery:tt}},{execute:rt})(Ke),at={pending:!1,error:!1,parsedQuery:{filters:[],page:1},search:{facets:{},query:{facets:[]},results:[],count:0}},it=(E={},b(E,"SEARCH_EXECUTE_PENDING",function(e,t){return Object.assign({},e,{pending:!0,error:!1,parsedQuery:t.parsedQuery})}),b(E,"SEARCH_EXECUTE_SUCCESS",function(e,t){return Object.assign({},e,{pending:!1,search:t.payload,error:!1})}),b(E,"SEARCH_EXECUTE_FAILURE",function(e,t){return Object.assign({},e,{pending:!1,error:t.error})}),E),ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:at,t=arguments[1],r=it[t.type];return r?r(e,t):e};t.default=Object(S.a)("search",ot)(Object(O.a)("Search",function(e){return r(236)("./"+e+".json")})(nt))}});
//# sourceMappingURL=search.60e3d59b6da6a66b3233.js.map