webpackJsonp([2],{213:function(e,t,n){"use strict";function r(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}t.a=r},214:function(e,t,n){"use strict";function r(e){return function(t,n,r){var a=Object(t);if(!Object(c.a)(t)){var o=Object(u.a)(n,3);t=Object(l.a)(t),n=function(e){return o(a[e],e,a)}}var i=e(t,n,r);return i>-1?a[o?t[i]:i]:void 0}}function a(e){if("number"==typeof e)return e;if(Object(h.a)(e))return m;if(Object(p.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(p.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(b,"");var n=v.test(e);return n||y.test(e)?E(e.slice(2),n?2:8):g.test(e)?m:+e}function o(e){if(!e)return 0===e?e:0;if((e=O(e))===j||e===-j){return(e<0?-1:1)*P}return e===e?e:0}function i(e){var t=w(e),n=t%1;return t===t?n?t-n:t:0}function s(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var a=null==n?0:z(n);return a<0&&(a=_(r+a,0)),Object(d.a)(e,Object(u.a)(t,3),a)}var u=n(47),c=n(18),l=n(27),f=r,d=n(205),p=n(17),h=n(19),m=NaN,b=/^\s+|\s+$/g,g=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,y=/^0o[0-7]+$/i,E=parseInt,O=a,j=1/0,P=1.7976931348623157e308,w=o,z=i,_=Math.max,C=s,N=f(C);t.a=N},349:function(e,t){e.exports={section:"User-2CxyhPJC",img:"User-2e2AtJT1",detail:"User-31zN56Lh"}},350:function(e,t){e.exports={publishing:"Layout-1E5hwZmN",organizationLogo:"Layout-2D3gKnp2",container:"Layout-1RiVBjUz"}},351:function(e,t){e.exports={container:"OrganizationPreview-2dAg6lEZ",organization:"OrganizationPreview-1414_TnG",img:"OrganizationPreview-3NmJwddX",detail:"OrganizationPreview-2jGdLKDs"}},352:function(e,t){e.exports={container:"Organizations-1ux6MTEE"}},353:function(e,t){e.exports={container:"Errors-1no9c7gb"}},354:function(e,t){e.exports={link:"OrganizationProducersPreview-lCQSPUCQ"}},355:function(e,t){e.exports={link:"OrganizationMetrics-mzlVD2BG"}},356:function(e,t){e.exports={container:"AddCatalogs-1mRJyIvK",card:"AddCatalogs-IcmgAWBx",loader:"AddCatalogs-2ef2C22Q",add:"AddCatalogs-2oEDFc9e",warningMsg:"AddCatalogs-Em02HEwg"}},357:function(e,t){e.exports={catalogsStyle:"SourceCatalogs-2-nuwxNW",catalog:"SourceCatalogs-1kKEsoZj",remove:"SourceCatalogs-B7QGfh_a",buttonStyle:"SourceCatalogs-2oNwxHWX"}},358:function(e,t){e.exports={content:"ManageOrganization-_u5wJFtp",previousPage:"ManageOrganization-2BYb5Z-8",organization:"ManageOrganization-3CIecK05"}},359:function(e,t){e.exports={msg:"ActivateOrganization-2nN0bVaj",activate:"ActivateOrganization-2kQTdbXR"}},360:function(e,t){e.exports={data:"DatasetToSelect-3CVv5iJF",progress:"DatasetToSelect-2i3CqS6J"}},361:function(e,t){e.exports={buttons:"DatasetsToBePublished-30i-IQDq",publishButton:"DatasetsToBePublished-4415I3f0",refresh:"DatasetsToBePublished-2ebaoAKc",disable:"DatasetsToBePublished-3X4sq9v0",selection:"DatasetsToBePublished-1djrlBM0",noData:"DatasetsToBePublished-3WtPqvmi"}},362:function(e,t){e.exports={data:"PublishedDatasets-1-bvX8CV"}},363:function(e,t){e.exports={container:"DatasetsPublication-3xUpydwy",header:"DatasetsPublication-2qM-CHxJ",success:"DatasetsPublication-2AjUtl2g",warning:"DatasetsPublication-3BMy1JSB",error:"DatasetsPublication-3zWtdgui"}},364:function(e,t){e.exports={previousPage:"OrganizationDatasets-3DstENWW"}},365:function(e,t){e.exports={container:"RelatedProducers-1ojfGJFE",header:"RelatedProducers-1dmoW5Ri",producers:"RelatedProducers-2HujMnzq",dissociate:"RelatedProducers-2yyH4-2r"}},366:function(e,t){e.exports={container:"UnrelatedProducers-2kLUVfXb",header:"UnrelatedProducers-CEwa0iv1",subtitle:"UnrelatedProducers-1FOvu-KQ",producers:"UnrelatedProducers-xRyuKU15",associate:"UnrelatedProducers-1SnRig_z"}},367:function(e,t){e.exports={item:"OtherProducersItem-2ei8gnOq"}},368:function(e,t){e.exports={container:"OtherProducers-2mmbO7qE",header:"OtherProducers-jHD9CLpM",subtitle:"OtherProducers-prw_WmIY",producers:"OtherProducers-2e7YAkOU",organization:"OtherProducers-2YfmcbId"}},369:function(e,t){e.exports={previousPage:"Producers-V1J01CdD"}},376:function(e,t,n){"use strict";function r(e){var t=e.user,n=e.organization,r=e.pageTitle,a=e.title,o=e.children;if(!t)return null;var i=n&&n.logo?n.logo:"/assets/no-img.png";return G.default.createElement("div",{className:oe.a.publishing},G.default.createElement($.Helmet,{title:r}),G.default.createElement(re,{user:t}),n?G.default.createElement(Z.Link,{to:"/publication/"+n.id},G.default.createElement("img",{className:oe.a.organizationLogo,alt:"organization logo",src:i})):null,G.default.createElement("div",{className:oe.a.container},G.default.createElement("h3",null,a),o))}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t,n,r){for(var a=n-1,o=e.length;++a<o;)if(r(e[a],t))return a;return-1}function u(e,t,n,r){var a=r?xe:Te.a,o=-1,i=t.length,s=e;for(e===t&&(t=Object(Se.a)(t)),n&&(s=Object(Ne.a)(e,Object(Ie.a)(n)));++o<i;)for(var u=0,c=t[o],l=n?n(c):c;(u=a(s,l,u,r))>-1;)s!==e&&ke.call(s,u,1),ke.call(e,u,1);return e}function c(e,t){return e&&e.length&&t&&t.length?Ae(e,t):e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function j(e){var t=e.organizationDetails,n=e.organization,r=e.user,a=e.metrics;return r?t?n&&a?G.default.createElement(ie,{user:r,organization:t,pageTitle:t.name,title:t.name},G.default.createElement(tt,e)):G.default.createElement(ie,{user:r,organization:t,pageTitle:t.name,title:t.name},G.default.createElement(at,{organizationId:t.id,onActivation:function(){return e.onActivation()}})):G.default.createElement(be,{errors:["Cette organisation n'existe pas sur data.gouv.fr"]}):G.default.createElement(be,{errors:["Vous devez être authentifié pour accéder à cette page"]})}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _(e,t){return function(n){function r(e){P(this,r);var t=w(this,n.call(this,e));return t.state={errors:[]},t}return z(r,n),r.prototype.componentDidMount=function(){var e=this,n=Promise.all(Object.keys(t).map(function(n){return Object(ve.c)(t[n],e,n)}));return n.then(function(){return e.setState({dependenciesReady:!0})}),n},r.prototype.componentWillUnmount=function(){return Object(ve.a)(this)},r.prototype.render=function(){var t=this.state,n=t.errors,r=t.dependenciesReady;return n.length?G.default.createElement(be,{errors:n}):r?G.default.createElement(e,Object.assign({},this.state,this.props)):G.default.createElement(Be.a,{isLoading:!0})},r}(G.Component)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function A(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function U(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function M(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function J(e,t){return e.filter(function(e){return e.associatedTo&&e.associatedTo===t})}function V(e){return e.filter(function(e){return!e.associatedTo})}function q(e,t){return e.filter(function(e){return e.associatedTo&&e.associatedTo!==t})}function Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function K(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function X(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var G=n(0),Z=n(8),$=n(26),ee=(n(1),n(349)),te=n.n(ee),ne=function(e){var t=e.user,n=t.avatar?{url:t.avatar,alt:t.slug}:{url:"assets/avatar.png",alt:"no avatar"};return G.default.createElement("div",{className:te.a.section},G.default.createElement(Z.Link,{className:te.a.detail,to:"/publication"},G.default.createElement("img",{className:te.a.img,src:n.url,alt:n.alt}),G.default.createElement("div",null,t.first_name," ",t.last_name)))},re=ne,ae=n(350),oe=n.n(ae),ie=r,se=n(351),ue=n.n(se),ce=function(e){var t=e.organization,n=t&&t.logo?t.logo:"/assets/no-img.png";return G.default.createElement("div",{className:ue.a.container},G.default.createElement(Z.Link,{className:ue.a.organization,to:"/publication/"+t.id},G.default.createElement("img",{className:ue.a.img,src:n,alt:t.slug}),G.default.createElement("div",{className:ue.a.detail},t.name)))},le=ce,fe=n(352),de=function(e){var t=e.organizations;return G.default.createElement("div",{className:fe.container},G.default.createElement($.Helmet,{title:"Vos organisations"}),t.map(function(e,t){return G.default.createElement(le,{key:t,organization:e})}))},pe=de,he=n(353),me=function(e){var t=e.errors,n=t.length>1?G.default.createElement("h3",null,"Des erreurs sont survenues"):G.default.createElement("h3",null,"Une erreur est survenue");return G.default.createElement("div",{className:he.container},G.default.createElement($.Helmet,{title:"Erreur"}),n,G.default.createElement("ul",null,t.map(function(e,t){return G.default.createElement("li",{key:t},e)})))},be=me,ge=n(43),ve=n(44),ye=function(e){function t(n){a(this,t);var r=o(this,e.call(this,n));return r.state={user:null,errors:[]},r}return i(t,e),t.prototype.componentWillMount=function(){var e=this;return Object(ve.c)(Object(ge.p)(),this,"user").then(function(){if(!e.state.user){var t=encodeURI("https://inspire.data.gouv.fr/publication"),n="https://inspire.data.gouv.fr/dgv/login?redirect="+t;document.location.replace(n)}})},t.prototype.componentWillUnmount=function(){return Object(ve.a)(this)},t.prototype.render=function(){var e=this.state,t=e.user,n=e.errors;return n.length?G.default.createElement(be,{errors:n}):t?G.default.createElement(ie,{user:t,pageTitle:"Vos organisations",title:"Vos organisations"},G.default.createElement(pe,{organizations:t.organizations})):G.default.createElement(be,{errors:["Vous devez être authentifié pour accéder à cette page"]})},t}(G.Component),Ee=ye,Oe=n(354),je=function(e){var t=e.organizationId,n=e.producers;return G.default.createElement("div",null,G.default.createElement("div",null,G.default.createElement("strong",null,n.length)," producteurs sont associés à votre organisation"),G.default.createElement("ul",null,n.map(function(e,t){return G.default.createElement("li",{key:t},e._id)})),G.default.createElement(Z.Link,{className:Oe.link,to:"/publication/"+t+"/producers"},"Associer des producteurs"))},Pe=je,we=n(355),ze=function(e){var t=e.organizationId,n=e.metrics,r=n.published,a=n.notPublishedYet,o=n.publishedByOthers;return G.default.createElement("div",null,G.default.createElement("p",null,G.default.createElement("strong",null,r)," jeux de données sont ",G.default.createElement("strong",null,"publiés et accessibles")," sur ",G.default.createElement("a",{href:"https://data.gouv.fr"},"data.gouv.fr")),G.default.createElement("p",null,G.default.createElement("strong",null,a)," jeux de données sont ",G.default.createElement("strong",null,"en attente de publication")),G.default.createElement("p",null,G.default.createElement("strong",null,o)," jeux de données sont ",G.default.createElement("strong",null,"publiés par d'autres producteurs")),G.default.createElement(Z.Link,{className:we.link,to:"/publication/"+t+"/datasets"},"Publier des données"))},_e=ze,Ce=n(100),Ne=n(52),Te=n(215),xe=s,Ie=n(58),Se=n(213),De=Array.prototype,ke=De.splice,Ae=u,Re=c,Ue=Object(Ce.a)(Re),Le=Ue,Be=n(13),We=n(212),Me=n(94),Je=n(96),Ve=n(356),qe=function(e){function t(n){l(this,t);var r=f(this,e.call(this,n));return r.state={errors:[]},r}return d(t,e),t.prototype.componentWillMount=function(){return Object(ve.c)(Object(ge.f)(),this,"catalogs")},t.prototype.componentWillUnmount=function(){return Object(ve.a)(this)},t.prototype.render=function(){var e=this.state.catalogs,t=this.props,n=t.sourceCatalogs,r=t.addCatalog;if(!this.state.catalogs)return G.default.createElement(Be.a,{isLoading:!0,className:Ve.loader});var a=Object(Je.a)(e,n),o=Object(Je.b)(a);return G.default.createElement("div",{className:Ve.container},o.map(function(e,t){return G.default.createElement("div",{key:t,className:Ve.card},G.default.createElement(Me.a,{catalog:e}),G.default.createElement(We.a,{style:Ve.add,action:function(){return r(e.id)},text:"Ajouter"}))}),G.default.createElement("div",{className:Ve.warningMsg},G.default.createElement("i",{className:"warning icon"}),"Seuls les catalogues disposant de données ouvertes et téléchargeables sont disponible ici."))},t}(G.Component),Ye=qe,He=function(e){function t(n){p(this,t);var r=h(this,e.call(this,n));return r.state={catalog:null,errors:[]},r}return m(t,e),t.prototype.componentWillMount=function(){return Object(ve.c)(Object(ge.e)(this.props.catalogId),this,"catalog")},t.prototype.componentWillUnmount=function(){return Object(ve.a)(this)},t.prototype.render=function(){var e=this.state.catalog;return e?G.default.createElement(Me.a,{catalog:e}):null},t}(G.Component),Ke=He,Qe=n(217),Fe=n(357),Xe=function(e){function t(n){b(this,t);var r=g(this,e.call(this,n));return r.state={catalogs:[].concat(r.props.sourceCatalogs),displayCatalogs:!1,errors:[]},r}return v(t,e),t.prototype.toggleCatalogList=function(){this.setState({displayCatalogs:!this.state.displayCatalogs})},t.prototype.addCatalog=function(e){var t=this,n=this.state.catalogs,r=this.props.organizationId;if(!n.includes(e)){var a=[].concat(n,[e]);Object(ge.r)(r,{sourceCatalogs:a}).then(function(){return t.setState({catalogs:a})})}},t.prototype.removeCatalog=function(e){var t=this,n=this.state.catalogs,r=this.props.organizationId;if(n.includes(e)){var a=Le(n,e);Object(ge.r)(r,{sourceCatalogs:a}).then(function(){return t.setState({catalogs:a})})}},t.prototype.render=function(){var e=this,t=this.state,n=t.displayCatalogs,r=t.catalogs,a=t.errors;if(a.length)return G.default.createElement(be,{errors:a});var o=G.default.createElement(We.a,{action:function(){return e.toggleCatalogList()},text:"Ajouter des catalogues"}),i=G.default.createElement(Ye,{sourceCatalogs:r,addCatalog:function(t){return e.addCatalog(t)}});return G.default.createElement("div",null,G.default.createElement("div",{className:Fe.catalogsStyle},r.map(function(t){return G.default.createElement("div",{key:t,className:Fe.catalog},G.default.createElement(Ke,{catalogId:t,size:"small"}),G.default.createElement(Qe.a,{style:Fe.remove,action:function(){return e.removeCatalog(t)},text:"Supprimer"}))})),G.default.createElement("div",{className:Fe.buttonStyle},n?i:o))},t}(G.Component),Ge=Xe,Ze=n(358),$e=n.n(Ze),et=function(e){var t=e.organization,n=e.metrics;return G.default.createElement("div",{className:$e.a.content},G.default.createElement("div",{className:$e.a.section},G.default.createElement("h4",null,"Catalogues source"),G.default.createElement(Ge,{organizationId:t._id,sourceCatalogs:t.sourceCatalogs})),G.default.createElement("div",{className:$e.a.section},G.default.createElement("h4",null,"Producteurs source"),G.default.createElement(Pe,{organizationId:t._id,producers:t.producers})),G.default.createElement("div",{className:$e.a.section},G.default.createElement("h4",null,"Jeux de données"),G.default.createElement(_e,{metrics:n,organizationId:t._id})),G.default.createElement("div",{className:$e.a.previousPage},G.default.createElement(Z.Link,{to:"/publication"},G.default.createElement("i",{className:"arrow left icon"})," Retour aux organisations")))},tt=et,nt=n(359),rt=function(e){function t(n){y(this,t);var r=E(this,e.call(this,n));return r.state={errors:[],activating:!1},r}return O(t,e),t.prototype.componentWillUnmount=function(){return Object(ve.a)(this)},t.prototype.activateAccount=function(){var e=this;return this.setState({activating:!0}),Object(ve.b)(Object(ge.r)(this.props.organizationId),this).promise.then(function(){e.setState({activating:!1}),e.props.onActivation()}).catch(function(t){t.isCanceled||e.setState({activating:!1,errors:["Impossible d'activer l'outil sur votre organisation"]})})},t.prototype.render=function(){var e=this,t=this.state,n=t.errors,r=t.activating;return n.length?G.default.createElement(be,{errors:n}):G.default.createElement("div",{className:nt.msg},G.default.createElement("h3",null,"L'outil de publication n'est pas encore activé."),G.default.createElement("button",{className:nt.activate,onClick:function(){return e.activateAccount()},disabled:r},"Activer l'outil"))},t}(G.Component),at=rt,ot=n(103),it=function(e){function t(n){C(this,t);var r=N(this,e.call(this,n));return r.state={dependencies:r.getDependencies()},r}return T(t,e),t.prototype.getDependencies=function(){var e=this.props.match.params.organizationId;return{user:Object(ge.p)(),metrics:Object(ot.a)(Object(ge.g)(e)),organization:Object(ot.a)(Object(ge.l)(e)),organizationDetails:Object(ot.a)(Object(ge.m)(e))}},t.prototype.update=function(){this.setState({dependencies:this.getDependencies()})},t.prototype.render=function(){var e=this,t=_(j,this.state.dependencies);return G.default.createElement(t,{onActivation:function(){return e.update()}})},t}(G.Component),st=it,ut=n(55),ct=n.n(ut),lt=n(360),ft=function(e){var t=e.dataset,n=e.isSelected,r=e.inProgress,a=e.change;return G.default.createElement("div",{className:lt.data},G.default.createElement(Z.Link,{to:"/datasets/"+t._id},t.title),r?G.default.createElement("div",{className:lt.progress},"Publication en cours..."):G.default.createElement("input",{type:"checkbox",checked:n,onChange:function(){return a(t)}}))},dt=ft,pt=n(361),ht=function(e){function t(n){x(this,t);var r=I(this,e.call(this,n));return r.state={toPublish:[],publicationsInProgress:[]},r}return S(t,e),t.prototype.publishDatasets=function(){var e=this.state.toPublish,t=this.props.organizationId;e.length&&(this.setState({publicationsInProgress:[].concat(e)}),e.map(function(e){return Object(ge.q)(e._id,t)}))},t.prototype.addDatasetToPublish=function(e){var t=this.state.toPublish;t.includes(e)||(t.push(e),this.setState({toPublish:t}))},t.prototype.removeDatasetToPublish=function(e){this.setState({toPublish:this.state.toPublish.filter(function(t){return t._id!==e._id})})},t.prototype.selection=function(){var e=this.props.datasets;this.state.toPublish.length===e.length?this.setState({toPublish:[]}):this.setState({toPublish:[].concat(e)})},t.prototype.render=function(){var e=this,t=this.props,n=t.datasets,r=t.update,a=this.state,o=a.toPublish,i=a.publicationsInProgress,s=o.length===n.length?"Tout désélectionner":"Tout sélectionner",u=o.length===n.length?"Publier toutes les données":"Publier les données sélectionnées",c=o.length?pt.publishButton:pt.disable;return n.length?G.default.createElement("div",null,n.map(function(t,n){var r=!0===o.includes(t);return G.default.createElement(dt,{key:n,dataset:t,isSelected:r,inProgress:!0===i.includes(t),change:r?function(t){return e.removeDatasetToPublish(t)}:function(t){return e.addDatasetToPublish(t)}})}),i.length?G.default.createElement("button",{className:pt.refresh,onClick:function(){return r()}},"Actualiser les données ",G.default.createElement("i",{className:"refresh icon"})):null,G.default.createElement("div",{className:pt.buttons},G.default.createElement("div",{className:pt.button+" "+pt.selection,onClick:function(){return e.selection()}},s),G.default.createElement("div",{className:pt.button+" "+c,onClick:function(){return e.publishDatasets()}},u))):G.default.createElement("div",{className:pt.noData},"Aucun jeu de données.")},t}(G.Component),mt=ht,bt=n(362),gt=function(e){var t=e.datasets;return t.length?G.default.createElement("div",null,t.map(function(e,t){return G.default.createElement("div",{key:t,className:bt.data},G.default.createElement(Z.Link,{to:"/datasets/"+e._id},e.title),G.default.createElement("a",{href:e.remoteUrl,target:"blank"},"Fiche data.gouv.fr"))})):G.default.createElement("div",{className:bt.data},"Aucun jeu de données.")},vt=gt,yt=n(363),Et=function(e){function t(){return D(this,t),k(this,e.apply(this,arguments))}return A(t,e),t.prototype.render=function(){var e,t=this.props,n=t.datasets,r=t.title,a=t.update,o=t.organizationId,i=t.status,s=n.sort(function(e,t){return e.title.localeCompare(t.title)}),u=ct()(yt.header,(e={},e[yt.success]="success"===i,e[yt.warning]="warning"===i,e[yt.error]="error"===i,e));return G.default.createElement("div",{className:yt.container},G.default.createElement("div",{className:u},G.default.createElement("div",null,r),G.default.createElement("div",null,n.length)),"error"===i?G.default.createElement(mt,{datasets:s,update:function(){return a()},organizationId:o}):G.default.createElement(vt,{datasets:s}))},t}(G.Component),Ot=Et,jt=n(364),Pt=function(e){var t=e.published,n=e.notPublishedYet,r=e.publishedByOthers,a=e.update,o=e.organizationId;return G.default.createElement("div",null,G.default.createElement(Ot,{datasets:n,organizationId:o,title:"Données en attente de publication",status:"error",update:function(){return a()}}),G.default.createElement(Ot,{datasets:t,organizationId:o,title:"Données publiées",status:"success"}),G.default.createElement(Ot,{datasets:r,organizationId:o,title:"Données publiées par une autre organisation",status:"warning"}),G.default.createElement("div",{className:jt.previousPage},G.default.createElement(Z.Link,{to:"/publication/"+o},G.default.createElement("i",{className:"arrow left icon"})," retour")))},wt=Pt,zt=function(e){function t(n){R(this,t);var r=U(this,e.call(this,n)),a=n.match.params.organizationId;return r.state={errors:[],organizationId:a},r}return L(t,e),t.prototype.componentWillMount=function(){return Promise.all([this.updateUser(),this.updatePublished(),this.updatePublishedByOthers(),this.updateNotPublishedYet()])},t.prototype.componentWillUnmount=function(){return Object(ve.a)(this)},t.prototype.updateUser=function(){return Object(ve.c)(Object(ge.p)(),this,"user")},t.prototype.updatePublished=function(){return Object(ve.c)(Object(ge.i)(this.state.organizationId),this,"published")},t.prototype.updateNotPublishedYet=function(){return Object(ve.c)(Object(ge.h)(this.state.organizationId),this,"notPublishedYet")},t.prototype.updatePublishedByOthers=function(){return Object(ve.c)(Object(ge.j)(this.state.organizationId),this,"publishedByOthers")},t.prototype.updateDatasets=function(){return Promise.all([this.updatePublished(),this.updateNotPublishedYet()])},t.prototype.render=function(){var e=this,t=this.state,n=t.organizationId,r=t.user,a=t.published,o=t.notPublishedYet,i=t.publishedByOthers,s=t.errors,u={published:a,notPublishedYet:o,publishedByOthers:i};if(s.length)return G.default.createElement(be,{errors:s});if(!r)return G.default.createElement(be,{errors:["Vous devez être authentifié pour accéder à cette page"]});var c=r.organizations.find(function(e){return e.id===n});return c&&u.published&&u.notPublishedYet&&u.publishedByOthers?G.default.createElement(ie,{user:r,organization:c,pageTitle:c.name,title:"Jeux de données"},G.default.createElement(wt,Object.assign({},u,{update:function(){return e.updateDatasets()},organizationId:n}))):null},t}(G.Component),_t=zt,Ct=n(365),Nt=n.n(Ct),Tt=function(e){var t=e.producers,n=e.action;return G.default.createElement("div",{className:Nt.a.container},G.default.createElement("div",{className:Nt.a.header},G.default.createElement("div",null,"Producteurs rattachés à votre organisation"),G.default.createElement("div",null,t.length)),G.default.createElement("div",{className:Nt.a.list},t.map(function(e,t){return G.default.createElement("div",{className:Nt.a.producers,key:t},G.default.createElement("div",null,e._id),G.default.createElement("button",{className:Nt.a.dissociate,onClick:function(){return n(e)}},"Dissocier"))})))},xt=Tt,It=n(366),St=n.n(It),Dt=function(e){var t=e.producers,n=e.action;return G.default.createElement("div",{className:St.a.container},G.default.createElement("div",{className:St.a.header},G.default.createElement("div",null,G.default.createElement("div",null,"Producteurs non rattachés"),G.default.createElement("div",{className:St.a.subtitle},"Ajoutez les producteurs dont vous souhaitez que les données ouvertes soient publiées dans votre organisation.")),G.default.createElement("div",null,t.length)),G.default.createElement("div",{className:St.a.list},t.map(function(e,t){return G.default.createElement("div",{className:St.a.producers,key:t},G.default.createElement("div",null,e._id),G.default.createElement("button",{className:St.a.associate,onClick:function(){return n(e)}},"Associer"))})))},kt=Dt,At=n(214),Rt=n(367),Ut=n.n(Rt),Lt=function(e){var t=e.organizations,n=e.producer,r=Object(At.a)(t,function(e){return e._id===n.associatedTo});return G.default.createElement("div",{className:Ut.a.item},"Rattaché à ",G.default.createElement("a",{href:"https://www.data.gouv.fr/fr/organizations/"+r._id+"/"},r.name))},Bt=Lt,Wt=n(368),Mt=n.n(Wt),Jt=function(e){function t(n){B(this,t);var r=W(this,e.call(this,n));return r.state={errors:[],organizationProducers:[]},r}return M(t,e),t.prototype.componentDidMount=function(){var e=this.props.producers,t=e.map(function(e){return e.associatedTo});return Object(ve.c)(Object(ge.o)(t),this,"organizations")},t.prototype.componentWillUnmount=function(){return Object(ve.a)(this)},t.prototype.render=function(){var e=this.state.organizations,t=this.props.producers;return e?G.default.createElement("div",{className:Mt.a.container},G.default.createElement("div",{className:Mt.a.header},G.default.createElement("div",null,G.default.createElement("div",null,"Producteurs rattachés à d'autres organisations"),G.default.createElement("div",{className:Mt.a.subtitle},G.default.createElement("div",null,"Les producteurs de cette liste ne peuvent pas être rattachés à votre compte organisation parce qu'ils sont déjà rattachés à un autre compte. N\\'hésitez pas à contacter l'organisation de rattachement si vous estimez que votre propre compte est plus pertinent."),G.default.createElement("p",null,"En cas de difficulté, contactez ",G.default.createElement("a",{href:"mailto:inspire@data.gouv.fr"},"notre équipe"),"."))),G.default.createElement("div",null,t.length)),G.default.createElement("div",{className:Mt.a.list},t.map(function(t,n){return G.default.createElement("div",{className:Mt.a.producers,key:n},G.default.createElement("div",null,t._id),G.default.createElement(Bt,{organizations:e,producer:t}))}))):null},t}(G.default.Component),Vt=Jt,qt=n(369),Yt=n.n(qt),Ht=function(e){function t(n){Y(this,t);var r=H(this,e.call(this,n));return r.state={errors:[],organizationProducers:[]},r}return K(t,e),t.prototype.componentDidMount=function(){return Promise.all([this.updateProducersToAssociate()])},t.prototype.componentWillUnmount=function(){return Object(ve.a)(this)},t.prototype.updateProducersToAssociate=function(){var e=this.props.organization;return Object(ve.c)(Object(ge.n)(e._id),this,"organizationProducers")},t.prototype.dissociate=function(e){var t=this,n=this.state.organizationProducers,r=this.props.organization;this.setState({organizationProducers:Le([].concat(n),e)}),Object(ge.d)(e._id,r._id).then(function(){return t.updateProducersToAssociate()})},t.prototype.associate=function(e){var t=this,n=this.state.organizationProducers,r=this.props.organization;this.setState({organizationProducers:Le([].concat(n),e)}),Object(ge.a)(e._id,r._id).then(function(){return t.updateProducersToAssociate()})},t.prototype.render=function(){var e=this,t=this.state,n=t.organizationProducers,r=t.errors,a=this.props.organization,o=J(n,a._id),i=V(n),s=q(n,a._id);return r.length?G.default.createElement(be,{errors:r}):n.length?G.default.createElement("div",null,G.default.createElement(xt,{producers:o,action:function(t){return e.dissociate(t)}}),G.default.createElement(kt,{producers:i,action:function(t){return e.associate(t)}}),G.default.createElement(Vt,{producers:s}),G.default.createElement("div",{className:Yt.a.previousPage},G.default.createElement(Z.Link,{to:"/publication/"+a._id},G.default.createElement("i",{className:"arrow left icon"})," Retour"))):null},t}(G.default.Component),Kt=Ht,Qt=function(e){function t(n){Q(this,t);var r=F(this,e.call(this,n)),a=n.match.params.organizationId;return r.state={errors:[],organizationId:a},r}return X(t,e),t.prototype.componentWillMount=function(){return Promise.all([this.updateUser(),this.updateOrganization()])},t.prototype.componentWillUnmount=function(){return Object(ve.a)(this)},t.prototype.updateUser=function(){return Object(ve.c)(Object(ge.p)(),this,"user")},t.prototype.updateOrganization=function(){return Object(ve.c)(Object(ge.l)(this.state.organizationId),this,"organization")},t.prototype.render=function(){var e=this.state,t=e.user,n=e.organization,r=e.errors,a=e.organizationId;if(r.length)return G.default.createElement(be,{errors:r});if(!t)return G.default.createElement(be,{errors:["Vous devez être authentifié pour accéder à cette page"]});if(!n)return null;var o=t.organizations.find(function(e){return e.id===a});return G.default.createElement(ie,{user:t,organization:o,pageTitle:n.name+" - Producteurs",title:"Producteurs"},G.default.createElement(Kt,{organization:n}))},t}(G.Component),Ft=Qt,Xt=function(){return G.default.createElement(Z.Switch,null,G.default.createElement(Z.Route,{exact:!0,path:"/publication",component:Ee}),G.default.createElement(Z.Route,{path:"/publication/:organizationId/datasets",component:_t}),G.default.createElement(Z.Route,{path:"/publication/:organizationId/producers",component:Ft}),G.default.createElement(Z.Route,{path:"/publication/:organizationId",component:st}))};t.default=Xt}});
//# sourceMappingURL=publication.a4681135e091d082ada2.js.map